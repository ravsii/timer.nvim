-- More fonts can be found here
-- https://patorjk.com/software/taag/

---@alias FontTable table< string, Font>
---@alias Font {
---  padding?: number,
---  ["s"]: string[],
---  [":"]: string[],
---  ["0"]: string[],
---  ["1"]: string[],
---  ["2"]: string[],
---  ["3"]: string[],
---  ["4"]: string[],
---  ["5"]: string[],
---  ["6"]: string[],
---  ["7"]: string[],
---  ["8"]: string[],
---  ["9"]: string[],
---}

---@type FontTable
local default_fonts = {
  ["DiamFont"] = {
    ["s"] = {
      "    ",
      " ▄▄▄",
      "▀▄▄ ",
      "▄▄▄▀",
    },
    [":"] = {
      " ",
      "█",
      " ",
      "█",
    },
    ["0"] = {
      "▄▄▄▄",
      "█  █",
      "█  █",
      "█▄▄█",
    },
    ["1"] = {
      "▄",
      "█",
      "█",
      "█",
    },
    ["2"] = {
      "▄▄▄▄",
      "   █",
      "█▀▀▀",
      "█▄▄▄",
    },
    ["3"] = {
      "▄▄▄▄",
      "   █",
      "▀▀▀█",
      "▄▄▄█",
    },
    ["4"] = {
      "▄  ▗▖",
      "█  ▐▌",
      "▀▀▀▜▌",
      "   ▐▌",
    },
    ["5"] = {
      "▄▄▄▄",
      "█   ",
      "▀▀▀█",
      "▄▄▄█",
    },
    ["6"] = {
      "▄▄▄▄",
      "█   ",
      "█▀▀█",
      "█▄▄█",
    },
    ["7"] = {
      "▗▄▄▄▖",
      "   ▐▌",
      "   ▐▌",
      "   ▐▌",
    },
    ["8"] = {
      "▄▄▄▄",
      "█  █",
      "█▀▀█",
      "█▄▄█",
    },
    ["9"] = {
      "▄▄▄▄",
      "█  █",
      "▀▀▀█",
      "▄▄▄█",
    },
  },

  ["Terrace"] = {
    ["s"] = {
      "          ",
      "          ",
      " ░███████ ",
      "░██       ",
      " ░███████ ",
      "       ░██",
      " ░███████ ",
    },
    [":"] = {
      "   ",
      "   ",
      "   ",
      "░██",
      "   ",
      "   ",
      "░██",
    },
    ["0"] = {
      "  ░████  ",
      " ░██ ░██ ",
      "░██ ░████",
      "░██░██░██",
      "░████ ░██",
      " ░██ ░██ ",
      "  ░████  ",
    },
    ["1"] = {
      "  ░██  ",
      "░████  ",
      "  ░██  ",
      "  ░██  ",
      "  ░██  ",
      "  ░██  ",
      "░██████",
    },
    ["2"] = {
      " ░██████ ",
      "░██   ░██",
      "      ░██",
      "  ░█████ ",
      " ░██     ",
      "░██      ",
      "░████████",
    },
    ["3"] = {
      " ░██████ ",
      "░██   ░██",
      "      ░██",
      "  ░█████ ",
      "      ░██",
      "░██   ░██",
      " ░██████ ",
    },
    ["4"] = {
      "   ░████  ",
      "  ░██ ██  ",
      " ░██  ██  ",
      "░██   ██  ",
      "░█████████",
      "     ░██  ",
      "     ░██  ",
    },
    ["5"] = {
      "░████████",
      "░██      ",
      "░███████ ",
      "      ░██",
      "░██   ░██",
      "░██   ░██",
      " ░██████ ",
    },
    ["6"] = {
      " ░██████ ",
      "░██   ░██",
      "░██      ",
      "░███████ ",
      "░██   ░██",
      "░██   ░██",
      " ░██████ ",
    },
    ["7"] = {
      "░█████████",
      "░██    ░██",
      "      ░██ ",
      "     ░██  ",
      "    ░██   ",
      "    ░██   ",
      "    ░██   ",
    },
    ["8"] = {
      " ░██████ ",
      "░██   ░██",
      "░██   ░██",
      " ░██████ ",
      "░██   ░██",
      "░██   ░██",
      " ░██████ ",
    },
    ["9"] = {
      " ░██████ ",
      "░██   ░██",
      "░██   ░██",
      " ░███████",
      "      ░██",
      "░██   ░██",
      " ░██████ ",
    },
  },
  ["tmplr"] = {
    ["s"] = {
      " ",
      "┏",
      "┛",
    },
    [":"] = {
      " ",
      "•",
      "•",
    },
    ["0"] = {
      "┏┓",
      "┃┫",
      "┗┛",
    },
    ["1"] = {
      "┓",
      "┃",
      "┻",
    },
    ["2"] = {
      "┏┓",
      "┏┛",
      "┗━",
    },
    ["3"] = {
      "┏┓",
      " ┫",
      "┗┛",
    },
    ["4"] = {
      "┃┃",
      "┗╋",
      " ┃",
    },
    ["5"] = {
      "┏━",
      "┗┓",
      "┗┛",
    },
    ["6"] = {
      "┏┓",
      "┣┓",
      "┗┛",
    },
    ["7"] = {
      "━┓",
      " ┃",
      " ╹",
    },
    ["8"] = {
      "┏┓",
      "┣┫",
      "┗┛",
    },
    ["9"] = {
      "┏┓",
      "┗┫",
      "┗┛",
    },
  },
}

local F = {}

---@param dur Duration
---@param font? string
---@return string[]
function F.from_duration(dur, font)
  local chars = default_fonts[font] or default_fonts["tmplr"]

  local max_rows = 0
  for _, v in pairs(chars) do
    max_rows = math.max(max_rows, #v)
  end

  local lines = {}
  for i = 1, max_rows do
    lines[i] = ""
  end

  local s = dur:into_hms()
  for i = 1, #s do
    local ch = s:sub(i, i)
    local digit = chars[ch]
    for row = 1, max_rows do
      lines[row] = lines[row] .. (digit[row] or string.rep("?", #digit[0]))
      if i ~= #s then
        lines[row] = lines[row] .. " "
      end
    end
  end

  return lines
end

return F
